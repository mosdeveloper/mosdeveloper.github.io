<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Zoom Meeting</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- ✅ Use the Zoom Web SDK bundle (CSS + JS from CDN) -->
  <link type="text/css" rel="stylesheet" href="https://source.zoom.us/3.14.2/css/bootstrap.css" />
  <link type="text/css" rel="stylesheet" href="https://source.zoom.us/3.14.2/css/react-select.css" />
  <link type="text/css" rel="stylesheet" href="https://source.zoom.us/3.14.2/css/zoom.css" />

  <style>
    body, html {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #zmmtg-root {
      height: 100%;
      width: 100%;
    }
  </style>
</head>
<body>
  <div id="zmmtg-root"></div>
  <div id="aria-notify-area"></div>

  <!-- ✅ Zoom Web SDK bundle -->
  <script src="https://source.zoom.us/3.14.2/lib/vendor/react.min.js"></script>
  <script src="https://source.zoom.us/3.14.2/lib/vendor/react-dom.min.js"></script>
  <script src="https://source.zoom.us/3.14.2/lib/vendor/redux.min.js"></script>
  <script src="https://source.zoom.us/3.14.2/lib/vendor/redux-thunk.min.js"></script>
  <script src="https://source.zoom.us/3.14.2/lib/vendor/lodash.min.js"></script>
  <script src="https://source.zoom.us/3.14.2/zoom-meeting-3.14.2.min.js"></script>

  <script>
    // Parse URL params
    const params = new URLSearchParams(window.location.search);
    const sdkKey = params.get("sdkKey");
    const meetingNumber = params.get("meetingNumber");
    const userName = params.get("userName");
    const userEmail = params.get("userEmail");
    const passWord = params.get("password");
    const role = parseInt(params.get("role") || "0");
    const signature = params.get("signature");

    console.log("Joining meeting:", { meetingNumber, userName });

    ZoomMtg.setZoomJSLib("https://source.zoom.us/3.14.2/lib", "/av");
    ZoomMtg.preLoadWasm();
    ZoomMtg.prepareWebSDK();

    ZoomMtg.init({
      leaveUrl: "https://zoom.us",
      success: function () {
        ZoomMtg.join({
          signature: signature,
          sdkKey: sdkKey,
          meetingNumber: meetingNumber,
          userName: userName,
          userEmail: userEmail,
          passWord: passWord,
          success: function () {
            console.log("Join meeting success");
          },
          error: function (err) {
            console.error("Join error", err);
          },
        });
      },
      error: function (err) {
        console.error("Init error", err);
      },
    });
  </script>
</body>
</html>
