<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Zoom Meeting</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Zoom Web SDK dependencies -->
  <script src="https://source.zoom.us/3.11.5/lib/vendor/react.min.js"></script>
  <script src="https://source.zoom.us/3.11.5/lib/vendor/react-dom.min.js"></script>
  <script src="https://source.zoom.us/3.11.5/lib/vendor/redux.min.js"></script>
  <script src="https://source.zoom.us/3.11.5/lib/vendor/redux-thunk.min.js"></script>
  <script src="https://source.zoom.us/3.11.5/lib/vendor/lodash.min.js"></script>
  <script src="https://source.zoom.us/zoom-meeting-3.11.5.min.js"></script>

  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    #zmmtg-root { height: 100%; width: 100%; }
  </style>
</head>
<body>
  <div id="zmmtg-root"></div>

  <script>
    // üîπ Parse query parameters from URL
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    const meetConfig = {
      sdkKey: getQueryParam("sdkKey"),
      meetingNumber: getQueryParam("meetingNumber"),
      userName: getQueryParam("userName") || "Guest",
      userEmail: getQueryParam("userEmail"),
      passWord: getQueryParam("password"),
      role: parseInt(getQueryParam("role") || "0"), // 0 = attendee, 1 = host
      signature: getQueryParam("signature")
    };

    console.log("Joining Zoom with config:", meetConfig);

    // üîπ Initialize Zoom Web SDK
    ZoomMtg.setZoomJSLib("https://source.zoom.us/3.11.5/lib", "/av");
    ZoomMtg.preLoadWasm();
    ZoomMtg.prepareWebSDK();

    ZoomMtg.init({
      leaveUrl: "about:blank",
      success: () => {
        ZoomMtg.join({
          signature: meetConfig.signature,
          sdkKey: meetConfig.sdkKey,
          meetingNumber: meetConfig.meetingNumber,
          userName: meetConfig.userName,
          userEmail: meetConfig.userEmail,
          passWord: meetConfig.passWord,
          success: () => console.log("‚úÖ Join success"),
          error: (err) => console.error("‚ùå Join error", err)
        });
      },
      error: (err) => console.error("‚ùå Init error", err)
    });
  </script>
</body>
</html>
